
subsection Dimension
  set dimension = 3
end

subsection Timer
  set enable timer = false
end

subsection Output
  set write results    = false
  set output directory = ../data/mms/
  set output prefix    = solution
end

subsection Mesh
  set verbosity = quiet
end

subsection Time integration
  set verbosity = quiet
  set dt        = 0.1
  set t_initial = 0
  set t_end     = 0.5
  set scheme    = BDF2
end

subsection Nonlinear solver
  set verbosity            = quiet
  set tolerance            = 1e-8
  set divergence_tolerance = 1e+4
  set max_iterations       = 50
  set enable_line_search   = true
  set analytic_jacobian    = true
end 

subsection Linear solver
  set verbosity      = quiet
  set method         = direct_mumps
end

subsection FiniteElements
  set Velocity degree = 2
  set Pressure degree = 1
end

subsection Physical properties
  set number of fluids = 1
  subsection Fluid 0
    set density             = 1.2345
    set kinematic viscosity = 9.8765
  end
end

subsection Initial conditions
  set to mms = true
end

subsection Fluid boundary conditions
  set number = 6
  set fix pressure constant = true
  subsection boundary 0
    set id   = 1
    set name = x_min
    set type = velocity_mms
  end
  subsection boundary 1
    set id   = 2
    set name = x_max
    set type = velocity_mms
  end
  subsection boundary 2
    set id   = 3
    set name = y_min
    set type = velocity_mms
  end
  subsection boundary 3
    set id   = 4
    set name = y_max
    set type = velocity_mms
  end
  subsection boundary 4
    set id   = 5
    set name = z_min
    set type = velocity_mms
  end
  subsection boundary 5
    set id   = 6
    set name = z_max
    set type = velocity_mms
  end
end

subsection Manufactured solution
  set enable            = true
  set type              = time
  set force source term = false
  set convergence steps = 3

  subsection Space convergence
    set use dealii cube mesh = true
    set norms to compute = L2_norm, Linfty_norm, H1_seminorm
  end

  subsection Time convergence
    set norm                = Linfty
    set use spatial mesh    = true
    set spatial mesh index  = 0
    set time step reduction = 0.5
  end

  # Divergence-free velocity field
  subsection exact velocity
    set Function expression = cos(t) * (x^2 + x*z + y^2); 1/(1 + t^2) * (x*y + z^2 + y^2); sin(t) * (x^2 + y^2 + z^2)
  end

  subsection exact pressure
    set Function expression = cos(t) * (x + y + z)
  end
end